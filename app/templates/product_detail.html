<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Product Details</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/common.css') }}">


  <style>
  :root {
    --cs-primary: #1e3a8a;
    --cs-primary-light: #3b82f6;
    --cs-primary-dark: #172554;

    --cs-bg: #f8fafc;
    --cs-surface: #ffffff;
    --cs-border: #e5e7eb;

    --cs-text: #0f172a;
    --cs-muted: #64748b;

    --cs-success: #16a34a;
    --cs-warning: #f59e0b;
    --cs-danger: #dc2626;
  }

  body {
    background: var(--cs-bg);
    color: var(--cs-text);
    font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont;
  }

  /* Navbar */
  .navbar {
    background: var(--cs-primary);
    box-shadow: 0 8px 24px rgba(30, 58, 138, 0.35);
  }

  .navbar-brand {
    color: #fff !important;
    font-weight: 600;
    letter-spacing: 0.3px;
  }

  /* Card */
  .card {
    background: var(--cs-surface);
    border-radius: 18px;
    border: 1px solid var(--cs-border);
    box-shadow: 0 16px 36px rgba(15, 23, 42, 0.08);
  }

  .card:hover {
    transform: translateY(-2px);
    transition: 0.25s ease;
  }
  
  .product-hero {
  background: linear-gradient(
    135deg,
    rgba(59,130,246,0.15),
    rgba(30,58,138,0.15)
  );
  padding: 1.25rem;
  border-radius: 14px;
}

  /* Headings */
  h3, h5 {
    font-weight: 600;
  }

  /* Status alerts */
  .alert-success {
  background: linear-gradient(
    135deg,
    rgba(22,163,74,0.15),
    rgba(16,185,129,0.15)
  );
  border: none;
  color: #065f46;
  font-weight: 600;
}

.alert-danger {
  background: linear-gradient(
    135deg,
    rgba(239,68,68,0.18),
    rgba(220,38,38,0.18)
  );
  border: none;
  color: #7f1d1d;
  font-weight: 600;
}


  /* Code blocks */
  code {
  background: #eef2ff;
  color: #1e3a8a;
  padding: 0.4rem 0.6rem;
  border-radius: 8px;
  font-size: 0.85rem;
  word-break: break-all;
}


  .info-block {
  background: #f8fafc;
  border-radius: 14px;
  padding: 1.25rem;
  border: 1px solid #e5e7eb;
}

.info-block h6 {
  font-weight: 600;
  margin-bottom: 0.75rem;
}

  /* QR section */
  .qr-box img {
  border-radius: 12px;
  box-shadow: 0 12px 28px rgba(15,23,42,0.15);
}

  /* Buttons */
  .btn-secondary {
    background: var(--cs-primary-light);
    border: none;
  }

  .btn-secondary:hover {
    background: var(--cs-primary);
  }

  footer {
    text-align: center;
    color: var(--cs-muted);
    font-size: 0.9rem;
  }
  @keyframes spin {
  to { transform: rotate(360deg); }
}
.chain-loader {
  display: flex;
  gap: 8px;
  justify-content: center;
}

/* Each chain link */
.chain-loader span {
  width: 18px;
  height: 10px;
  border: 3px solid #2563eb;
  border-radius: 12px;
  position: relative;
  animation: chainMove 1.2s ease-in-out infinite;
  opacity: 0.4;
}

/* Staggered animation */
.chain-loader span:nth-child(1) { animation-delay: 0s; }
.chain-loader span:nth-child(2) { animation-delay: 0.15s; }
.chain-loader span:nth-child(3) { animation-delay: 0.3s; }
.chain-loader span:nth-child(4) { animation-delay: 0.45s; }

/* Animation */
@keyframes chainMove {
  0% {
    transform: translateY(0);
    opacity: 0.4;
  }
  50% {
    transform: translateY(-6px);
    opacity: 1;
  }
  100% {
    transform: translateY(0);
    opacity: 0.4;
  }
}
</style>
</head>
<body>
  <!-- ===== Chain Loader ===== -->
<div id="pageLoader" style="
  position: fixed;
  inset: 0;
  background: rgba(248,250,252,0.92);
  backdrop-filter: blur(6px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
">

  <div style="text-align:center;">

    <div class="chain-loader">
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>

    <div style="
      margin-top: 0.9rem;
      font-size: 0.75rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: #475569;
    ">
      Building Trust
    </div>

  </div>

</div>


  
  {% include "_header.html" %}


  <div class="product-hero mb-4">
  <h3 class="mb-1">{{ product.name }}</h3>
  <p class="small mb-0">
    Product ID · {{ product.product_id }}
  </p>
</div>



      <!-- QR Code -->
      {% if product.qr_path %}
      <div class="qr-box text-center mb-4">
        <img src="{{ url_for('static', filename=product.qr_path) }}" width="140">
        <p class="small text-muted mt-2">
          Scan to verify authenticity
        </p>
      </div>
      {% endif %}

      <!-- Tamper Status -->
      {% if tamper_ok %}
      <div class="alert alert-success text-center fs-5">
        ✅ AUTHENTIC PRODUCT<br>
        <small>Blockchain verification successful</small>
      </div>
      {% else %}
      <div class="alert alert-danger text-center fs-5">
        ⚠️ TAMPERING DETECTED<br>
        <small>Blockchain hash mismatch</small>
      </div>
      {% endif %}

      <!-- Product Description -->
      <div class="info-block mb-4">
        <h6>Description</h6>
        <p class="mb-0">{{ product.description }}</p>
      </div>


      <!-- Hash Information -->
      <div class="info-block mb-4">
        <h6>Integrity Data</h6>
        <p class="mb-1"><strong>Local Hash:</strong><br><code>{{ local_hash }}</code></p>
        <p class="mb-1"><strong>On-chain Hash:</strong><br><code>{{ onchain_hash }}</code></p>
        <p class="mb-1"><strong>Timestamp:</strong><br><code>{{ timestamp }}</code></p>
        <p class="mb-0"><strong>Recorded By:</strong><br><code>{{ submitter }}</code></p>
      </div>

      <!-- Anomaly Section -->
      <div class="info-block mb-4">
        <h6>Detected Anomalies</h6>

        {% if anomalies %}
        <ul class="list-group list-group-flush">
          {% for a in anomalies %}
            <li class="list-group-item">
               ⚠ {{ a }}
            </li>
          {% endfor %}
        </ul>
        {% else %}
          <p class="text-success mb-0">
            ✔ No anomalies detected in this record.
          </p>
        {% endif %}
      </div>


      <div class="text-end mt-4">
        <a href="/" class="btn btn-secondary px-4 rounded-pill">
  Back to Dashboard
</a>
      </div>
    </div>
  </div>

  <footer class="text-center mt-4 text-muted">
    <p>© 2025 Blockchain Supply Chain | Data Integrity Verified</p>
  </footer>
  <script>
  const loader = document.getElementById("pageLoader");

  // Show loader on internal navigation
  document.addEventListener("click", function (e) {
    const link = e.target.closest("a");
    if (!link) return;

    const href = link.getAttribute("href");

    // Ignore empty, anchors, external, new tabs
    if (
      !href ||
      href.startsWith("#") ||
      href.startsWith("http") ||
      link.target === "_blank"
    ) return;

    loader.style.display = "flex";
  });

  // Hide loader when page finishes loading
  window.addEventListener("load", function () {
    loader.style.display = "none";
  });
</script>

</body>
</html>
